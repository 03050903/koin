== About koin-ktor

The `koin-ktor` project is dedicated to bring dependency injection for Ktor.

=== Gradle setup

Add the `koin-android` dependency to your Gradle project:

[source,gradle,subs="attributes"]
----
// Add Jcenter to your repositories if needed
repositories {
    jcenter()
}
dependencies {
    // Reflection features for Koin
    compile 'org.koin:koin-ktor:{revnumber}'
}
----

=== Start Koin & just inject

Just start Koin container before starting ktor:

[source,kotlin]
----
fun main(args: Array<String>) {
    // Start Koin
    startKoin(listOf(helloAppModule), logger = SLF4JLogger())
    // Start Ktor
    embeddedServer(Netty, commandLineEnvironment(args)).start()
}
----

KoinComponent powers are available from `Application` class:

[source,kotlin]
----
fun Application.main() {
    //...

    // Lazy inject HelloService
    val service by inject<HelloService>()

    // Routing section
    routing {
        get("/hello") {
            call.respondText(service.sayHello())
        }
    }
}
----

From `Routing` class:

[source,kotlin]
----
fun Application.main() {
    //...

    // Lazy inject HelloService
    val service by inject<HelloService>()

    // Routing section
    routing {
        v1()
    }
}

fun Routing.v1() {

    // Lazy inject HelloService from within a Ktor Routing Node
    val service by inject<HelloService>()

    get("/v1/hello") {
        call.respondText("[/v1/hello] " + service.sayHello())
    }
}

----


From `Route` class:

[source,kotlin]
----
fun Application.main() {
    //...

    // Lazy inject HelloService
    val service by inject<HelloService>()

    // Routing section
    routing {
        v1()
    }
}

fun Routing.v1() {
    hello()
}

fun Route.hello() {

    // Lazy inject HelloService from within a Ktor Route
    val service by inject<HelloService>()

    get("/v1/bye") {
        call.respondText("[/v1/bye] " + service.sayHello())
    }
}

----






